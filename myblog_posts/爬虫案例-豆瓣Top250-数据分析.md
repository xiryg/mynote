---
title: çˆ¬è™«æ¡ˆä¾‹-è±†ç“£Top250
tags: çˆ¬è™«
swiper_index: 10
categories: çˆ¬è™«
description: è±†ç“£Top250çˆ¬å–-æ•°æ®åˆ†æåŠå¯è§†åŒ–
cover: 'https://img.tucang.cc/api/image/show/0ac1f5c9c3af75384d937bf8655d9264'
abbrlink: f8e9693d
date: 2023-09-22 22:47:36
---

# æ•°æ®è·å–

* **ç½‘å€** : https://movie.douban.com/top250?start=
* **ç›¸å…³åº“** : `requests` `bs4è§£æ` `reæ­£åˆ™è¡¨è¾¾å¼` 
* **æ•°æ®åˆ†æåŠå¯è§†åŒ–**: `pandas` `matplotylib` `wordcloud` 
* **å­˜å‚¨** : `csv` 

******

## requestè·å–ç½‘é¡µå†…å®¹

```python
import requests
url = 'https://movie.douban.com/top250?start='
response = requests.get(url)
print(response)
```

```python
>>> <Response [418]>
# å“åº”çŠ¶æ€ç 418è¡¨ç¤ºè®¿é—®çš„ç½‘ç«™æœ‰åçˆ¬è™«æœºåˆ¶ï¼Œè€Œè§£å†³æ–¹æ³•å°±æ˜¯å¸¦è¯·æ±‚å¤´header(user-agent)è®¿é—®ã€‚
```

>**1.ä¿¡æ¯å“åº” (100â€“199)**
>
>**2.æˆåŠŸå“åº”(200â€“299)**
>
>**3.é‡å®šå‘æ¶ˆæ¯(300â€“399)**
>
>**4.å®¢æˆ·ç«¯é”™è¯¯å“åº” (400â€“499)**
>
>**5.æœåŠ¡ç«¯é”™è¯¯å“åº”(500â€“599)**

å¦‚ä½•è·å– `user-agent` :

![](https://img.tucang.cc/api/image/show/93d8136f2d4c79db4d6b45aebca768df)

åœ¨ç½‘é¡µä¸­ï¼ŒæŒ‰ `F12` æ‰“å¼€å¼€å‘è€…æ¨¡å¼ï¼Œé€‰ç½‘ç»œï¼ŒæŒ‰F5åˆ·æ–°é¡µé¢ï¼Œç‚¹å‡»æ ‡å¤´ï¼Œå³å¯æŸ¥åˆ° `User-Agent` 

é€šè¿‡è®¾ç½®åˆç†çš„ User-Agent æ¥æ¨¡æ‹ŸçœŸå®ç”¨æˆ·çš„è¯·æ±‚ï¼Œä»è€Œé™ä½è¢«ç½‘ç«™å°ç¦æˆ–è¯†åˆ«ä¸ºçˆ¬è™«çš„é£é™©ï¼Œåˆç†å³å¯ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šã€‚

è®¾ç½®å¥½ `User-Agent` åï¼š

```python
# è®¾ç½®è¯·æ±‚å¤´
headers = {
    "User-Agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) "
                  "Chrome/117.0.0.0 Mobile Safari/537.36 Edg/117.0.2045.31"
}

response = requests.get(url, headers=headers)
print(response)
print(type(requests.get(url)))
```

```python
>>> <Response [200]>
>>> <class 'requests.models.Response'>
```

å“åº”çŠ¶æ€ç 200è¡¨ç¤ºæœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚.

**requestsåº“çš„ç›¸å…³å‡½æ•°** :

| å‡½æ•°                          | è¯´æ˜                                                     |
| ----------------------------- | -------------------------------------------------------- |
| `requests.get()`              | å‘é€ GET è¯·æ±‚ï¼Œè·å–æŒ‡å®š URL çš„å†…å®¹                       |
| `requests.post()`             | å‘é€ POST è¯·æ±‚ï¼Œå‘æŒ‡å®š URL æäº¤æ•°æ®                      |
| `requests.put()`              | å‘é€ PUT è¯·æ±‚ï¼Œæ›´æ–°æŒ‡å®š URL çš„å†…å®¹                       |
| `requests.delete()`           | å‘é€ DELETE è¯·æ±‚ï¼Œåˆ é™¤æŒ‡å®š URL çš„èµ„æº                    |
| `requests.head()`             | å‘é€ HEAD è¯·æ±‚ï¼Œè·å–æŒ‡å®š URL çš„å“åº”å¤´ä¿¡æ¯                |
| `requests.options()`          | å‘é€ OPTIONS è¯·æ±‚ï¼Œè·å–æŒ‡å®š URL æ”¯æŒçš„è¯·æ±‚æ–¹æ³•å’Œå¤´éƒ¨ä¿¡æ¯ |
| `requests.request()`          | é€šç”¨æ¥å£ï¼Œå‘é€è‡ªå®šä¹‰è¯·æ±‚æ–¹æ³•ï¼ˆGET/POST/PUT/DELETE ç­‰ï¼‰   |
| `requests.session()`          | åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ï¼Œç”¨äºå‘é€å¤šä¸ªè¯·æ±‚å¹¶ä¿æŒä¼šè¯çŠ¶æ€    |
| `response.text`               | è·å–å“åº”å†…å®¹ï¼ˆä»¥æ–‡æœ¬å½¢å¼è¿”å›ï¼‰                           |
| `response.json()`             | è·å–å“åº”å†…å®¹ï¼Œå¹¶å°† JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º Python å­—å…¸æˆ–åˆ—è¡¨   |
| `response.status_code`        | è·å–å“åº”çš„çŠ¶æ€ç                                          |
| `response.headers`            | è·å–å“åº”çš„å¤´éƒ¨ä¿¡æ¯                                       |
| `response.cookies`            | è·å–å“åº”çš„ Cookie ä¿¡æ¯                                   |
| `response.raise_for_status()` | å¦‚æœå“åº”çŠ¶æ€ç ä¸æ˜¯ 200ï¼ŒæŠ›å‡ºå¼‚å¸¸                         |
| `response.content`            | è·å–å“åº”å†…å®¹çš„åŸå§‹å­—èŠ‚æµ                                 |
| `response.url`                | è·å–å“åº”çš„ URL                                           |
| `response.request`            | è·å–ä¸å“åº”ç›¸å…³çš„è¯·æ±‚å¯¹è±¡                                 |

## ç”µå½±ç›¸å…³ä¿¡æ¯çš„å®šä½å’Œè·å–

![](https://img.tucang.cc/api/image/show/cc16abdff60840bd6efa4c992ed49055)

å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¦å®šä½çš„æ˜¯ **`ç”µå½±åç§°`**ã€ **`å¯¼æ¼”`** ã€**`ä¸»æ¼”`**ã€ **`ä¸Šæ˜ å¹´ä»½`**ã€ **`åˆ¶ç‰‡å›½å®¶`**ã€ **`ç±»å‹`**ã€ **`è¯„åˆ†`**ã€ **`å½±è¯„`**. 

F12ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å¯ä»¥å‘ç°ï¼Œæ¯éƒ¨ç”µå½±çš„ä¿¡æ¯å…¨éƒ¨åœ¨ **<div class="info"> </div>**é‡Œ

![](https://img.tucang.cc/api/image/show/097ac8367b9fbdb5d415eba5515829df)

### å®šä½ç›¸å…³ä¿¡æ¯ä½ç½®

```python
from bs4 import BeautifulSoup
soup.find_all('div', class_='info')  # è·å–å…¨éƒ¨æ ‡ç­¾ä¸ºdiv classå±æ€§ä¸ºinfoçš„æ‰€æœ‰å…ƒç´ ï¼Œä¸ºä¸€ä¸ªåˆ—è¡¨
type(soup.find_all('div', class_='info')) 
len(type(soup.find_all('div', class_='info')))
```

```python
>>> bs4.element.ResultSet
>>> 25
```

### å®šä½ç”µå½±åç§°ï¼Œè¯„åˆ†æ•°æ®ï¼Œå½±è¯„

ç”±ä¸Šè¿° `soup.find_all('div', class_='info')` è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œfor å¾ªç¯è¿­ä»£å³å¯ï¼š

```python
for item in soup.find_all('div', class_='info'):
    # è·å–ç”µå½±åç§°
    name = item.find('span', class_='title').text.strip()  
    # è·å–è¯„åˆ†
    rating = item.find('span', class_='rating_num').text.strip()
    # è·å–å½±è¯„
    inq = item.find('span', class_='inq').text.strip() if item.find('span', class_='inq') else "æ— "
    
```

{% tabs test1 %}
<!-- tab ç”µå½±åç§° -->
>```python
>out[]:
># è‚–ç”³å…‹çš„æ•‘èµ éœ¸ç‹åˆ«å§¬ é˜¿ç”˜æ­£ä¼  æ³°å¦å°¼å…‹å· è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†· 
># åƒä¸åƒå¯» ç¾ä¸½äººç”Ÿ æ˜Ÿé™…ç©¿è¶Š è¾›å¾·å‹’çš„åå• ç›—æ¢¦ç©ºé—´ 
># æ¥šé—¨çš„ä¸–ç•Œ å¿ çŠ¬å…«å…¬çš„æ•…äº‹ æµ·ä¸Šé’¢ç´å¸ˆ ä¸‰å‚»å¤§é—¹å®è±å æ”¾ç‰›ç­çš„æ˜¥å¤© 
># æœºå™¨äººæ€»åŠ¨å‘˜ ç–¯ç‹‚åŠ¨ç‰©åŸ æ— é—´é“ æ§æ–¹è¯äºº å¤§è¯è¥¿æ¸¸ä¹‹å¤§åœ£å¨¶äº² 
># ç†”ç‚‰ æ•™çˆ¶ è§¦ä¸å¯åŠ å½“å¹¸ç¦æ¥æ•²é—¨ æœ«ä»£çš‡å¸ 
>```
<!-- endtab -->

<!-- tab è¯„åˆ† -->

>```python
>out[]:
># 9.7 9.6 9.5 9.5 9.4 
># 9.4 9.6 9.4 9.6 9.4 
># 9.4 9.4 9.3 9.2 9.3 
># 9.3 9.2 9.3 9.6 9.2 
># 9.4 9.3 9.3 9.2 9.3 
>```

<!-- endtab -->

<!-- tab å½±è¯„ -->
![](https://img.tucang.cc/api/image/show/dd3102a7126f7955a929f97cc2208405)
<!-- endtab -->
{% endtabs %}

å·²ç»æˆåŠŸè·å–åˆ°ç”µå½±åç§°ï¼Œè¯„åˆ†æ•°æ®ï¼Œå½±è¯„.

******

### è·å–å¯¼æ¼”ï¼Œä¸»æ¼”ï¼Œä¸Šæ˜ å¹´ä»½ï¼Œåˆ¶ç‰‡å›½å®¶ï¼Œç±»å‹

ç”±äºè¿™äº›ä¿¡æ¯ï¼Œåœ¨ä¸€ä¸ªæ ‡ç­¾ä¸‹ï¼Œè™½ç„¶ä¾æ—§å¯ä»¥ç”¨bs4ï¼Œä¸è¿‡æˆ‘åœ¨è¿™é‡Œç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥å®šä½å…·ä½“ä¿¡æ¯ã€‚

![](https://img.tucang.cc/api/image/show/8b1788445d0dda4f925c836002f46cbf)

```python
# æ­£åˆ™è¡¨è¾¾å¼
pattern1 = r'å¯¼æ¼”: (.*?)\s'  # ç”¨äºåŒ¹é… å¯¼æ¼”
pattern2 = r'ä¸»æ¼”: (.*?)\.\.\.'  # ç”¨äºåŒ¹é… æ¼”å‘˜
pattern3 = r'(\d+)'  # ç”¨äºåŒ¹é… ä¸Šæ˜ å¹´ä»½
pattern4 = r'/\s*([\u4e00-\u9fa5\s]+)\s*/'  # ç”¨äºåŒ¹é… åˆ¶ç‰‡å›½å®¶
pattern5 = r'/(?P<genre>[^/\n]+)'  # ç”¨äºåŒ¹é… ç±»å‹
```

```python
for item in soup.find_all('div', class_='info'):
    item_o = item.p.text # è·å–ç›¸å…³ä¿¡æ¯æ–‡æœ¬
    # è·å–å¯¼æ¼”
    director_match = re.search(pattern1, item_o)
    director = director_match.group(1) if director_match else 'æ— '
    
    # è·å–ä¸»æ¼”
    actor_match = re.search(pattern2, item_o)
    actor = actor_match.group(1) if actor_match else 'æ— '
    
    # è·å–å¹´ä»½
    year_match = re.search(pattern3, item_o)
    year = year_match.group(1) if year_match else 'æ— '

    # è·å–åˆ¶ç‰‡å›½å®¶
    country_match = re.search(pattern4, item_o)
    country = country_match.group(1) if country_match else None

    # è·å–ç±»å‹
    genres_match = re.findall(pattern5, item_o)
    genre = genres_match[-1].replace("&nbsp;", "") if genres_match else ''
```

## è·å–æ‰€æœ‰é¡µç”µå½±ä¿¡æ¯

è‡³æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»è·å–åˆ°äº†æ‰€æœ‰ä¸ç”µå½±ç›¸å…³çš„ä¿¡æ¯ï¼Œä¸è¿‡æ˜¯å…¶ä¸­ä¸€é¡µçš„ã€‚

æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ url 

>ç¬¬ä¸€é¡µï¼šhttps://movie.douban.com/top250?start=0&filter=
>
>ç¬¬äºŒé¡µï¼šhttps://movie.douban.com/top250?start=25&filter=
>
>ç¬¬ä¸‰é¡µï¼šhttps://movie.douban.com/top250?start=50&filter=

å¯ä»¥çœ‹åˆ°ï¼Œç½‘é¡µåœ¨åªåœ¨ `start=` æœ‰å˜åŒ–ï¼Œæˆ‘ä»¬åªéœ€è¦å†™ä¸€ä¸ªå¾ªç¯ï¼Œæ¥æ›´è¿­`url`

```python
for start in range(0, 250 + 1, 25):
    url = f"https://movie.douban.com/top250?start={start}&filter="
    response = requests.get(url, headers=headers)
    html = response.text
```

å¥½äº†ï¼Œå†å°†ä¹‹å‰ä»£ç è·Ÿåœ¨åè¾¹ï¼Œå°±èƒ½è·å–æ‰€æœ‰çš„ç”µå½±æ•°æ®

# æ•°æ®å­˜å‚¨

```python
for start in range(0, 250 + 1, 25):
    url = f"https://movie.douban.com/top250?start={start}&filter="
    response = requests.get(url, headers=headers)
    html = response.text
    """
    ç›¸å…³ä»£ç 
    """
    movie = {'rank': start + i + 1, 'name': name, 'director': director, 'actor': actor, 'year': year,
             'country': country, 'genre': genre, 'rating': rating, 'inq': inq}

    movies.append(movie)
    
with open('movies.csv', 'w', newline='', encoding='utf-8') as csvfile:
    fieldnames = ['Top', 'ç”µå½±åç§°', 'å¯¼æ¼”', 'ä¸»æ¼”', 'ä¸Šæ˜ å¹´ä»½', 'åˆ¶ç‰‡å›½å®¶', 'ç±»å‹', 'è¯„åˆ†', 'å½±è¯„']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)

    writer.writeheader()
    for movie in movies:
        writer.writerow(
            {'Top': movie['rank'], 'ç”µå½±åç§°': movie['name'], 'å¯¼æ¼”': movie['director'],'ä¸»æ¼”': movie['actor'],
             'ä¸Šæ˜ å¹´ä»½': movie['year'], 'åˆ¶ç‰‡å›½å®¶': movie['country'].strip(), 'ç±»å‹': movie['genre'].strip(),
             'è¯„åˆ†': movie['rating'],
             'å½±è¯„': movie['inq']})
```

`movie.csv` æ–‡ä»¶æ ¼å¼å¦‚ï¼š

![](https://img.tucang.cc/api/image/show/ee452a4da4791bd965000d62c7f0f672)

è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸçˆ¬å–åˆ°è±†ç“£Top250çš„ç”µå½±æ•°æ®

******

# æ•°æ®åˆ†æåŠå¯è§†åŒ–


```python
import pandas as pd

# è¯»å–ç”µå½±ä¿¡æ¯æ•°æ®
data = pd.read_csv('movies.csv')
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Top</th>
      <th>ç”µå½±åç§°</th>
      <th>å¯¼æ¼”</th>
      <th>ä¸»æ¼”</th>
      <th>ä¸Šæ˜ å¹´ä»½</th>
      <th>åˆ¶ç‰‡å›½å®¶</th>
      <th>ç±»å‹</th>
      <th>è¯„åˆ†</th>
      <th>å½±è¯„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>è‚–ç”³å…‹çš„æ•‘èµ</td>
      <td>å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹</td>
      <td>è’‚å§†Â·ç½—å®¾æ–¯ Tim Robbins /</td>
      <td>1994</td>
      <td>ç¾å›½</td>
      <td>çŠ¯ç½ª å‰§æƒ…</td>
      <td>9.7</td>
      <td>å¸Œæœ›è®©äººè‡ªç”±ã€‚</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>éœ¸ç‹åˆ«å§¬</td>
      <td>é™ˆå‡¯æ­Œ</td>
      <td>å¼ å›½è£ Leslie Cheung / å¼ ä¸°æ¯… Fengyi Zha</td>
      <td>1993</td>
      <td>ä¸­å›½å¤§é™† ä¸­å›½é¦™æ¸¯</td>
      <td>å‰§æƒ… çˆ±æƒ… åŒæ€§</td>
      <td>9.6</td>
      <td>é£åç»ä»£ã€‚</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>é˜¿ç”˜æ­£ä¼ </td>
      <td>ç½—ä¼¯ç‰¹Â·æ³½ç±³å‰æ–¯</td>
      <td>æ±¤å§†Â·æ±‰å…‹æ–¯ Tom Hanks /</td>
      <td>1994</td>
      <td>ç¾å›½</td>
      <td>å‰§æƒ… çˆ±æƒ…</td>
      <td>9.5</td>
      <td>ä¸€éƒ¨ç¾å›½è¿‘ç°ä»£å²ã€‚</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>æ³°å¦å°¼å…‹å·</td>
      <td>è©¹å§†æ–¯Â·å¡æ¢…éš†</td>
      <td>è±æ˜‚çº³å¤šÂ·è¿ªå¡æ™®é‡Œå¥¥ Leonardo</td>
      <td>1997</td>
      <td>ç¾å›½ å¢¨è¥¿å“¥</td>
      <td>å‰§æƒ… çˆ±æƒ… ç¾éš¾</td>
      <td>9.5</td>
      <td>å¤±å»çš„æ‰æ˜¯æ°¸æ’çš„ã€‚</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>è¿™ä¸ªæ€æ‰‹ä¸å¤ªå†·</td>
      <td>å•å…‹Â·è´æ¾</td>
      <td>è®©Â·é›·è¯º Jean Reno / å¨œå¡”è‰Â·æ³¢ç‰¹æ›¼</td>
      <td>1994</td>
      <td>æ³•å›½ ç¾å›½</td>
      <td>å‰§æƒ… åŠ¨ä½œ çŠ¯ç½ª</td>
      <td>9.4</td>
      <td>æ€ªèœ€é»å’Œå°èè‰ä¸å¾—ä¸è¯´çš„æ•…äº‹ã€‚</td>
    </tr>
  </tbody>
</table>
</div>




```python
# è·å–æ•°æ®çš„åŸºæœ¬ä¿¡æ¯
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 250 entries, 0 to 249
    Data columns (total 9 columns):
     #   Column  Non-Null Count  Dtype  
    ---  ------  --------------  -----  
     0   Top     250 non-null    int64  
     1   ç”µå½±åç§°    250 non-null    object 
     2   å¯¼æ¼”      250 non-null    object 
     3   ä¸»æ¼”      248 non-null    object 
     4   ä¸Šæ˜ å¹´ä»½    250 non-null    int64  
     5   åˆ¶ç‰‡å›½å®¶    250 non-null    object 
     6   ç±»å‹      250 non-null    object 
     7   è¯„åˆ†      250 non-null    float64
     8   å½±è¯„      250 non-null    object 
    dtypes: float64(1), int64(2), object(6)
    memory usage: 17.7+ KB



```python
# ç»Ÿè®¡æ•°å€¼åˆ—çš„ç»Ÿè®¡ä¿¡æ¯
data.describe().round(2).T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Top</th>
      <td>250.0</td>
      <td>125.50</td>
      <td>72.31</td>
      <td>1.0</td>
      <td>63.25</td>
      <td>125.5</td>
      <td>187.75</td>
      <td>250.0</td>
    </tr>
    <tr>
      <th>ä¸Šæ˜ å¹´ä»½</th>
      <td>250.0</td>
      <td>2000.53</td>
      <td>15.76</td>
      <td>1931.0</td>
      <td>1994.00</td>
      <td>2004.0</td>
      <td>2011.00</td>
      <td>2021.0</td>
    </tr>
    <tr>
      <th>è¯„åˆ†</th>
      <td>250.0</td>
      <td>8.93</td>
      <td>0.27</td>
      <td>8.4</td>
      <td>8.70</td>
      <td>8.9</td>
      <td>9.10</td>
      <td>9.7</td>
    </tr>
  </tbody>
</table>
</div>




```python
# è®¡ç®—è¯„åˆ†çš„å¹³å‡å€¼
avg_rating = data['è¯„åˆ†'].mean()
print("å¹³å‡è¯„åˆ†ï¼š", avg_rating)
```

    å¹³å‡è¯„åˆ†ï¼š 8.932799999999999


æ¥ä¸‹æ¥åˆ†æï¼š

>1. åˆ†æå‡ºç”µå½±ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å¯¼æ¼”ï¼ˆå‰5ä¸ªï¼‰ï¼›
>2. åˆ†æå‡ºç”µå½±ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ä¸»æ¼”ï¼ˆä»¥é¦–ä¸ªä¸»æ¼”ä¸ºå‡†ï¼Œå‰5ä¸ªï¼‰ï¼›
>3. åˆ†æå‡ºç”µå½±ä¸­ä¸Šæ˜ å¹´ä»½å‡ºç°è¿‡çš„å¹´ä»½ï¼›
>4. åˆ†æå‡ºç”µå½±ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„åˆ¶ç‰‡å›½å®¶ï¼ˆå‰5ä¸ªï¼‰ï¼›
>5. åˆ†æå‡ºç”µå½±ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç”µå½±ç±»å‹ï¼ˆå‰5ä¸ªï¼‰ï¼›
>6. æŸ¥æ‰¾è¯„åˆ†æœ€é«˜çš„5éƒ¨ç”µå½±ï¼Œå¹¶è·å–å®ƒä»¬çš„å½±è¯„ã€‚



```python
import pandas as pd

# è¯»å–ç”µå½±æ•°æ®
df = pd.read_csv('movies.csv')

# å¡«å……NaNå€¼ä¸º''
df['ä¸»æ¼”'].fillna('', inplace=True)

# è¿‡æ»¤æ‰ä¸»æ¼”ä¸º"æ— "çš„ç”µå½±
df = df[df['ä¸»æ¼”'] != 'æ— ']

# åˆ†æå¯¼æ¼”å’Œä¸»æ¼”
directors = df['å¯¼æ¼”'].value_counts().index.tolist()[:5]
actors = df['ä¸»æ¼”'].apply(lambda x: x.split(' ')[0]).value_counts().index.tolist()[:5]

# åˆ†æä¸Šæ˜ å¹´ä»½å’Œåˆ¶ç‰‡å›½å®¶
years = df['ä¸Šæ˜ å¹´ä»½'].value_counts().index.tolist()
countries = df['åˆ¶ç‰‡å›½å®¶'].value_counts().index.tolist()[:5]

# åˆ†æç”µå½±ç±»å‹
genres = []
for genres_str in df['ç±»å‹']:
    genres.extend(genres_str.split(' '))
genres = pd.Series(genres).value_counts().index.tolist()[:5]

# åˆ†æè¯„åˆ†å’Œå½±è¯„
top_ratings = df.sort_values(by='è¯„åˆ†', ascending=False).head(5)
reviews = top_ratings['å½±è¯„'].tolist()

# æ‰“å°åˆ†æç»“æœ
print('å¯¼æ¼”ï¼š',directors)
print('ä¸»æ¼”ï¼š', actors)
print('ä¸Šæ˜ å¹´ä»½ï¼š', years)
print('åˆ¶ç‰‡å›½å®¶ï¼š', countries)
print('ç”µå½±ç±»å‹ï¼š', genres)
print('å½±è¯„ï¼š', reviews)

```

    å¯¼æ¼”ï¼š ['å®«å´éª', 'å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°', 'å²è’‚æ–‡Â·æ–¯çš®å°”ä¼¯æ ¼', 'æå®‰', 'ç‹å®¶å«']
    ä¸»æ¼”ï¼š ['ä¸¹å°¼å°”Â·é›·å¾·å…‹é‡Œå¤«', 'å‘¨æ˜Ÿé©°', 'é©¬ç‰¹Â·è¾¾è’™', 'æ±¤å§†Â·æ±‰å…‹æ–¯', 'è±æ˜‚çº³å¤šÂ·è¿ªå¡æ™®é‡Œå¥¥']
    ä¸Šæ˜ å¹´ä»½ï¼š [2004, 2010, 1994, 2013, 2014, 2008, 2009, 2003, 2016, 2001, 1997, 1993, 2015, 1995, 2002, 2011, 2006, 2018, 2012, 2000, 1991, 2017, 1999, 2005, 1987, 2007, 1998, 1990, 1988, 1984, 2019, 1992, 1989, 1986, 1957, 1974, 1954, 1940, 2021, 1950, 1966, 1931, 2020, 1968, 1952, 1960, 1982, 1961, 1979, 1972, 1996, 1939, 1953, 1936, 1975, 1965, 1971]
    åˆ¶ç‰‡å›½å®¶ï¼š ['ç¾å›½', 'æ—¥æœ¬', 'ä¸­å›½é¦™æ¸¯', 'è‹±å›½ ç¾å›½', 'éŸ©å›½']
    ç”µå½±ç±»å‹ï¼š ['å‰§æƒ…', 'çˆ±æƒ…', 'å–œå‰§', 'å†’é™©', 'çŠ¯ç½ª']
    å½±è¯„ï¼š ['å¸Œæœ›è®©äººè‡ªç”±ã€‚', 'æœ€ç¾çš„è°è¨€ã€‚', 'æ¯”åˆ©Â·æ€€å¾·æ»¡åˆ†ä½œå“ã€‚', 'é£åç»ä»£ã€‚', 'æ‹¯æ•‘ä¸€ä¸ªäººï¼Œå°±æ˜¯æ‹¯æ•‘æ•´ä¸ªä¸–ç•Œã€‚']



```python
import pandas as pd
import matplotlib.pyplot as plt
from wordcloud import WordCloud

plt.rcParams['font.sans-serif'] = ['SimHei']   # é˜²æ­¢ä¸­æ–‡ä¹±ç 
plt.rcParams['axes.unicode_minus'] = False

# è¯»å–ç”µå½±æ•°æ®
df = pd.read_csv('movies.csv')

# å¡«å……NaNå€¼ä¸º''
df['ä¸»æ¼”'].fillna('', inplace=True)

# è¿‡æ»¤æ‰ä¸»æ¼”ä¸º"æ— "çš„ç”µå½±
df = df[df['ä¸»æ¼”'] != 'æ— ']

# åˆ†æå¯¼æ¼”å’Œä¸»æ¼”
directors = df['å¯¼æ¼”'].value_counts().head(5)
actors = df['ä¸»æ¼”'].apply(lambda x: x.split(' ')[0]).value_counts().head(5)

# åˆ†æè¯„åˆ†å’Œå½±è¯„
top_ratings = df.sort_values(by='è¯„åˆ†', ascending=False).head(25)
reviews = ' '.join(top_ratings['å½±è¯„'].tolist())

```


```python
import matplotlib.pyplot as plt

# æŒ‡å®šé¢œè‰²å’Œå›¾ä¾‹æ ‡ç­¾
colors = ['steelblue', 'darkorange', 'forestgreen', 'purple', 'red']
plt.figure(figsize=(10, 5))
directors.plot(kind='barh', color=colors)
plt.xlabel('ç”µå½±æ•°é‡', fontsize=12)
plt.ylabel('å¯¼æ¼”', fontsize=12)
plt.title('å‰5ä½å¯¼æ¼”çš„é¢‘ç‡åˆ†å¸ƒ', fontsize=14)
plt.grid(axis='x', linestyle='--')

plt.show()

```

![](https://img.tucang.cc/api/image/show/bb29bde020f18fbd253520bd41f9a547)

```python
# ç»˜åˆ¶ä¸»æ¼”é¢‘ç‡åˆ†å¸ƒçš„é¥¼å›¾
plt.figure(figsize=(6, 6))
actors_plot = actors.plot(kind='pie', autopct='%1.1f%%', colors=['skyblue', 'orange', 'limegreen', 'gold', 'red'])

plt.title('å‰5ä½ä¸»æ¼”çš„é¢‘ç‡åˆ†å¸ƒ', fontsize=14)
plt.axis('equal')  # ä½¿é¥¼å›¾ä¸ºæ­£åœ†å½¢

# è°ƒæ•´å›¾ä¾‹çš„ä½ç½®å’Œå¤§å°ï¼Œä¸è¦†ç›–å›¾ç‰‡
actors_legend = actors_plot.legend(fontsize=10, loc='center left', bbox_to_anchor=(1, 0.5))

plt.show()

```

![](https://img.tucang.cc/api/image/show/32e4f2014220d373f91785009e8c56f7)

```python
wordcloud = WordCloud(width=800, height=400,
                      background_color='white',
                      colormap='viridis',
                      font_path="D:\\ä¸»é¢˜\\ç»å…¸å®‹ä½“.ttf",
                      max_font_size=150,
                      max_words=200).generate(reviews)

plt.figure(figsize=(10, 5))
plt.imshow(wordcloud, interpolation='bilinear')
plt.axis('off')
plt.title('å½±è¯„å…³é”®è¯è¯äº‘å›¾', fontsize=16)
plt.show()

```

 ![](https://img.tucang.cc/api/image/show/11258c3ea03e88daa6aab8263437eb21)

   # æ€»ç»“

ä»¥ä¸Šå°±æ˜¯çˆ¬å–è±†ç“£Top250çš„ä»‹ç»ï¼Œå’Œæ•°æ®åˆ†æä»¥åŠå¯è§†åŒ–ã€‚

**ç›¸å…³æ–‡ä»¶**

[[çˆ¬è™«æºç ](https://gist.github.com/xiryg/0cbfb159e4f82bb499f358a56aa51b31)] åšäº†ä¿®æ”¹å’Œä¼˜åŒ–ï¼Œè¿™é‡Œå°±ä¸å†è®²è§£äº†ã€‚

[[movies.csv](https://gist.github.com/xiryg/994a6d9fc7b3c0f3e5828f1e2dbf6347)]  çˆ¬å–æ•°æ®çš„csvæ–‡ä»¶

[[**Bean_Data_Analytics_section.ipynb**](https://gist.github.com/xiryg/01741125494660dcc6e7179af1eaf417#file-bean_data_analytics_section-ipynb)]  æ•°æ®åˆ†æåŠå¯è§†åŒ–éƒ¨åˆ†

æœ‰é—®é¢˜çš„è¯ï¼Œå¯ä»¥åœ¨è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥è”ç³»æˆ‘ã€‚

**å¤‡æ³¨ï¼š**

>æœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµï¼Œå¯¹äºçˆ¬è™«æµ…å°è¾„æ­¢ï¼Œä»¥å…å¯¹æœåŠ¡å™¨é€ æˆè´Ÿæ‹…

******

ğŸ†—ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œå•¦ï¼ï¼ï¼
